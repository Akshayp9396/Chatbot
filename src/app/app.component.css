/* =====================================================
   Chat UI Styles
   -----------------------------------------------------
   1) Layout / Header
   2) Canvas / Messages
   3) Quick Replies
   4) Composer (input, buttons, recording)
   5) Recording Chip (bars, timers)
   6) Attach Menu & Status Pills
   7) Attachment Previews
   8) Message Media (images, docs)
   9) Utilities / Animations / Media Queries
   ===================================================== */


   

/* =====================================================
   1) Layout / Header
   ===================================================== */
.shell{
  width:100vw; height:100vh;
  display:flex; flex-direction:column;
  background:#fff;
}

/* Top gradient bar */
.topbar{
  flex-shrink:0;
  height:72px;  padding: 0 14px !important;   /* was 0 10px */
  display:flex; align-items:center; justify-content:space-between;
  color:#fff;
  background:linear-gradient(90deg,#3b5bfd 0%,#009dff 100%);
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}

.brand{ display:flex; align-items:center;  gap: 8px ;       ; }
.logo{
  width: clamp(40px, 6vw, 56px) !important;  /* match .avatar clamp */
  height: clamp(40px, 6vw, 56px) !important;
  display: block;
  line-height: 0;
  width:56px; height:56px;
  display:block; overflow:hidden; object-fit:contain;
}
.titles{ display:flex; flex-direction:column; line-height:1.1; }
.title{ font-weight:600; font-size:18px; }
.online{ font-size:12px; opacity:.95; }
.dot{
  width:8px; height:8px;
  display:inline-block; border-radius:50%;
  background:#22c55e; margin-right:6px;
}

/* Header actions: icon-only */
.actions{ display:flex; align-items:center; gap:10px; }
.icon-btn{
  all:unset;
  display:inline-flex; align-items:center; justify-content:center;
  width:clamp(32px,4.2vw,40px); height:clamp(32px,4.2vw,40px);
  cursor:pointer; border-radius:8px; line-height:0;
}
.icon-btn .ico{
  width:clamp(20px,3vw,28px); height:clamp(20px,3vw,28px);
  display:block; filter:brightness(0) invert(1);
}
.icon-btn:hover .ico{ opacity:.9; transform:scale(1.05); }
.icon-btn:active .ico{ transform:scale(.96); }
.icon-btn:focus-visible{ outline:2px solid #fff; outline-offset:2px; }


/* =====================================================
   2) Canvas / Messages
   ===================================================== */
.canvas{
  flex:1 1 auto; min-height:0;
  overflow:auto; background:#fff;
  
}

.msgs{
  display:flex; flex-direction:column; gap:10px;
  padding:14px;
  /* padding-block-end: calc(14px + var(--composer-h)) !important; */
  
}



/* rows & avatars */
.row{
  display:flex; align-items:flex-end; justify-content:flex-start;
  gap:8px;
}
.row.me{ justify-content:flex-end; }

.avatar{
  flex:0 0 auto;
  width:clamp(40px,6vw,56px); height:clamp(40px,6vw,56px);
  display:flex; align-items:center; justify-content:center;
  overflow:hidden; border-radius:50%;
  background:#eef2ff; border:1px solid #e5e7eb;
}
.avatar.me{ background:#e8f0f7; border-color:#bbe3f7; }
.avatar img{ width:70%; height:70%; display:block; object-fit:contain; }

/* bubbles */
.bubble{
  max-width:78%;
  padding:10px 12px; border-radius:12px;
  border:1px solid #e5e7eb;
  font-size:14px; line-height:1.35;
  white-space:pre-wrap; word-break:break-word;
  will-change:transform,opacity;
}
.bubble.bot{
  background:#ECECEC; border-color:#dbeafe;
  border-radius:0 16px 16px 16px;
  animation:bubbleInLeft 260ms cubic-bezier(.82,.69,.27,1) both;
}
.bubble.me{
  color:#4361EE; background:#ECECEC; border-color:#bbe3f7;
  border-radius:16px 16px 0 16px;
  animation:bubbleInRight 260ms cubic-bezier(.22,.9,.27,1) both;
}

/* typing (3 dots) */
.bubble.typing{
  display:inline-flex; align-items:center; gap:6px;
  border-style:dashed; animation:none !important;
}
.bubble.typing span{
  width:6px; height:6px; border-radius:50%;
  display:inline-block; background:#9ca3af;
  animation:blink 1.2s infinite;
}
.bubble.typing span:nth-child(2){ animation-delay:.2s; }
.bubble.typing span:nth-child(3){ animation-delay:.4s; }

/* system chip (optional) */
.system{
  margin:0 auto; padding:6px 10px; border-radius:10px;
  font-size:12px; color:#92400e;
  background:#fff7ed; border:1px dashed #fb923c;
}

/* stack (bubble + meta) */
.stack{
  display:flex; flex-direction:column; align-items:flex-start;
  max-width:78%;
}
.row.me .stack{ align-items:flex-end; }
.bubble{ max-width:100%; }

.meta-line{
  display:flex; align-items:center; gap:6px;
  margin-top:4px; font-size:11px; line-height:1; color:#9ca3af;
  opacity:0; transform:translateY(-2px);
  animation:metaFade 180ms ease-out 140ms forwards;
  will-change:transform,opacity;
}
.meta-line.left{ align-self:flex-start; }
.meta-line.right{ align-self:flex-end; }
.meta-line .tick{ font-size:12px; opacity:.9; }
.meta-line .tick-img{
  width:12px; height:12px; display:inline-block;
  filter:grayscale(1) brightness(.65); transform:translateY(1px);
}

/* avatars pop in subtly */
.row .avatar{
  opacity:0; transform:scale(.88);
  animation:avatarPop 180ms ease-out forwards;
}
.row.me .avatar{ animation-delay:60ms; }


/* =====================================================
   3) Quick replies (chips)
   ===================================================== */
.quick-row{
  display:flex; flex-wrap:wrap; gap:10px;
  margin:0 0 10px 0; justify-content:center;
}
.chip{
  appearance:none; border:none; cursor:pointer; white-space:nowrap;
  display:inline-flex; align-items:center; gap:8px;
  padding:8px 12px; border-radius:999px; line-height:1;
  font-size:clamp(12px,1.6vw,14px); color:#0f172a;
  background:
    linear-gradient(#fff,#fff) padding-box,
    linear-gradient(90deg,#3b5bfd,#00d2ff) border-box;
  border:2px solid transparent; box-shadow:0 2px 8px rgba(0,0,0,.04);
  transition:transform .12s ease, box-shadow .12s ease;
}
.chip:hover{ transform:translateY(-1px); box-shadow:0 6px 16px rgba(59,91,253,.12); }
.chip:active{ transform:translateY(0); }
.chip:focus-visible{ outline:none; box-shadow:0 0 0 3px rgba(59,91,253,.35); }
@media (max-width:420px){ .chip{ padding:6px 10px; font-size:12px; } }


/* =====================================================
   4) Composer (container, input, buttons)
   ===================================================== */
.hidden{ display:none !important; } /* used for toggling & file inputs */

.composer-wrap{
  padding:12px;
  padding-bottom:calc(12px + env(safe-area-inset-bottom));
  background:transparent;
}

.composer{
  position:relative;
  display:grid; align-items:center; gap:12px;
  grid-template-columns:56px 1fr 56px 64px; /* + | input | mic | send */
  width:100%; max-width:100%;
  height:80px; padding:12px 12px;
  border-radius:999px; overflow:visible;
  background:
    linear-gradient(#fff,#fff) padding-box,
    linear-gradient(90deg,#3b5bfd,#51aeff,#00cdf6) border-box;
  border:2px solid transparent; box-shadow:0 10px 30px rgba(0,0,0,.08);
  background-size:300% 300%; animation:moveGradient 6s linear infinite;
}

/* circle buttons (+ and mic) */
.circle-btn{
  width:56px; height:56px;
  display:flex; align-items:center; justify-content:center;
  border:none; border-radius:50%; cursor:pointer;
  background:#fff; color:#3b5bfd;
  transition:background .2s ease, transform .2s ease;
  font-size:clamp(28px,3.6vw,40px);
}
.circle-btn img{ width:34px; height:34px; display:block; }
.circle-btn:hover{ background:#f1f5ff; transform:scale(1.05); }
.circle-btn.mic.rec{ background:#fff0f0; color:#ef4444; }
.circle-btn.mic.rec img{
  filter:invert(39%) sepia(92%) saturate(3298%) hue-rotate(348deg) brightness(96%) contrast(101%);
}

/* send */
.send-btn{
  width:56px; height:56px; padding:0;
  display:flex; align-items:center; justify-content:center;
  border:none; border-radius:50%; cursor:pointer;
  transition:transform .2s ease, opacity .2s ease; color:#fff;
}
.send-btn img{ width:50px; height:50px; display:block; }
.send-btn:disabled{ opacity:.6; cursor:not-allowed; }
.send-btn:hover:not(:disabled){ transform:scale(1.05); }

/* input */
.composer input{
  height:56px; min-width:0; /* allow the grid cell to shrink on small screens */
  border:none; outline:none; background:transparent;
  font-size:18px; padding:0 6px; color:#0f172a;
}
.composer input::placeholder{ color:#94a3b8; }

/* helper row (optional) */
.helper{
  display:flex; align-items:center; gap:12px;
  margin-top:8px; font-size:12px; color:#64748b;
}


/* =====================================================
   5) Recording Chip (compact, responsive)
   ===================================================== */
.rec-chip{
  width:100%; height:var(--chip-h,3.5rem); /* ~56px default */
  display:flex; align-items:center; gap:0.5rem;
  box-sizing:border-box; padding:0 0.375rem; /* ~6px */
  border:1px dashed #0053f800; border-radius:999px;
  background:#fff;

  /* responsive sizing for the wave track & bars */
  --wave-min: clamp(3.25rem,14vw,5.75rem); /* ~52–92px */
  --wave-max: clamp(5rem,26vw,7.5rem);     /* ~80–120px */
  --wave-h:   clamp(0.875rem,2.2vh,1rem);  /* ~14–16px */

  --bars:14;
  --bar-gap: clamp(0.125rem,0.6vw,0.1875rem); /* ~2–3px */
  --bar-w:   clamp(0.18rem,0.7vw,0.25rem);    /* ~3–4px */
  --bar-r:   0.1875rem; /* 3px */

  --bar-c1:#1f7aff;   /* base blue */
  --bar-c2:#00d2ff;   /* cyan tip */
  --bar-glow:0 0 0.35rem rgba(0,136,255,.35);
}

/* Buttons stay fixed size; never shrink */
.rec-btn{
  flex:0 0 2.5rem; width:2.5rem; height:2.5rem;
  display:grid; place-items:center;
  border:none; border-radius:50%; cursor:pointer;
  background:#fff; font-weight:600; font-size:1.125rem; line-height:1;
  transition:background .15s ease, transform .12s ease;
}
.rec-btn:hover{ background:#f8fafc; transform:translateY(-0.0625rem); }
.rec-x{ color:#0289ff; }
.rec-ok{ color:#0289ff; }

/* Center area is flexible and can shrink; prevents button overlap */
.rec-body{
  flex:1 1 auto; min-width:0; /* allow truncation instead of pushing */
  display:grid; grid-template-columns:auto minmax(var(--wave-min),var(--wave-max)) 1fr;
  align-items:center; gap:0.625rem; /* ~10px */
}

/* Left cluster (dot + timer) */
.rec-left{ display:flex; align-items:center; gap:0.5rem; }
.rec-dot{
  width:0.625rem; height:0.625rem; border-radius:50%;
  background:radial-gradient(circle at 40% 40%, #ff6b6b 0%, #ef4444 60%);
  box-shadow:0 0 0 0 rgba(239,68,68,.45);
  animation:recPulse 1.2s ease-out infinite; /* @keyframes provided elsewhere */
}
.rec-timer{
  font-variant-numeric:tabular-nums;
  font-size:0.875rem; color:#ef4444;
}

/* Modern, smooth, responsive waveform */
.rec-wave{
  position:relative;
  display:flex; align-items:flex-end; gap:var(--bar-gap);
  width:100%; min-width:var(--wave-min); max-width:var(--wave-max);
  height:var(--wave-h); overflow:hidden;
  will-change:transform;
}
.rec-wave::before{
  content:"";
  position:absolute; inset:-0.125rem; /* ~2px */
  background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.28) 50%,transparent 100%);
  transform:translateX(-100%);
  animation:waveSheen 3s linear infinite;
  pointer-events:none;
}
.rec-wave span{
  width:calc((100% - (var(--bars) - 1) * var(--bar-gap)) / var(--bars));
  height:55%; border-radius:var(--bar-r);
  background:linear-gradient(180deg,var(--bar-c2) 0%,var(--bar-c1) 100%);
  box-shadow:var(--bar-glow); transform-origin:bottom center;
  animation:waveScale 1.15s ease-in-out infinite; will-change:transform;
}
.rec-wave span:nth-child(4n){   animation-delay:.05s; }
.rec-wave span:nth-child(4n+1){ animation-delay:.15s; }
.rec-wave span:nth-child(4n+2){ animation-delay:.25s; }
.rec-wave span:nth-child(4n+3){ animation-delay:.35s; }

.rec-text{
  min-width:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  font-size:0.875rem; color:#0f172a;
}
.rec-text.empty{ color:#94a3b8; }

/* Tiny phones */
@media (max-width:26.25rem){ /* 420px */
  .rec-btn{ flex-basis:2.25rem; width:2.25rem; height:2.25rem; font-size:1rem; }
  .rec-body{ gap:0.375rem; } /* ~6px */
  .rec-chip{
    --wave-min: clamp(3rem,18vw,5.25rem);
    --wave-max: clamp(4.5rem,24vw,5.75rem);
    --wave-h:   clamp(0.8rem,2.4vh,0.875rem);
    --bar-gap:  clamp(0.1rem,0.8vw,0.16rem);
    --bar-w:    clamp(0.16rem,0.8vw,0.22rem);
  }
  .rec-text{ font-size:0.8125rem; } /* ~13px */
}


/* =====================================================
   6) Attach Menu & Status Pills
   ===================================================== */
.attach-anchor{ position:relative; } /* wrapper around the + button */

/* click-away layer so a click outside closes the menu */
.attach-backdrop{
  position:fixed; inset:0; z-index:40;
  background:transparent;
}

/* the menu card */
.attach-menu{
  position:absolute; left:0; bottom:64px; /* above + button */
  width:min(320px,86vw);
  padding:8px; border-radius:14px; z-index:50;
  background:#fff; border:1px solid #e5e7eb;
  box-shadow:0 14px 40px rgba(0,0,0,.14);
}

/* tiny arrow pointing to the + button */
.attach-menu::before{
  content:"";
  position:absolute; left:18px; bottom:-8px;
  border:8px solid transparent; border-top-color:#fff;
  filter:drop-shadow(0 -1px 0 #e5e7eb);
}

.att-item{
  width:100%;
  display:flex; align-items:center; gap:12px;
  padding:10px; border:0; border-radius:10px; cursor:pointer;
  background:#fff; text-align:left;
  transition:background .15s ease, transform .1s ease;
}
.att-item:hover{ background:#f8fafc; }
.att-item:active{ transform:translateY(1px); }

.att-ico{ width:26px; height:26px; object-fit:contain; }
.att-text{ display:grid; gap:2px; }
.att-title{ font-size:14px; font-weight:600; color:#0f172a; }
.att-sub{ font-size:12px; color:#64748b; }

/* keep menu tidy on very small phones */
@media (max-width:420px){
  .attach-menu{ width:min(300px,92vw); }
  .att-sub{ font-size:11px; }
}

/* status chips row (e.g., TTS enabled) */
.attach-status{
  display:flex; flex-wrap:wrap; gap:8px;
  justify-content:center; margin:6px 0 10px;
}
.pill{
  display:inline-flex; align-items:center; gap:8px;
  padding:6px 10px; border-radius:999px; font-size:12px; color:#0f172a;
  background:
    linear-gradient(#fff,#fff) padding-box,
    linear-gradient(90deg,#3b5bfd,#00d2ff) border-box;
  border:2px solid transparent; box-shadow:0 2px 8px rgba(0,0,0,.04);
}
.pill-ico{ width:16px; height:16px; object-fit:contain; }
.pill-x{
  all:unset;
  width:18px; height:18px; border-radius:50%;
  display:grid; place-items:center; cursor:pointer;
  color:#64748b; font-weight:700; line-height:1;
}
.pill-x:hover{ background:#eef2ff; color:#1d4ed8; }


/* =====================================================
   7) Attachment Previews (above composer)
   ===================================================== */
.previews{
  display:flex; flex-direction:column; gap:8px;
  justify-content:flex-start; align-items:stretch;
  margin:6px 0 10px;
}

/* strips */
.img-strip,
.doc-strip{
  display:flex; flex-wrap:wrap; gap:8px;
  justify-content:flex-start;
}

/* image thumbnails */
.thumb{
  position:relative; width:64px; height:64px;
  overflow:hidden; border-radius:12px;
  background:#fff; border:1px solid #e5e7eb;
  box-shadow:0 2px 8px rgba(0,0,0,.04);
}
.thumb img{ width:100%; height:100%; display:block; object-fit:cover; }

/* close button on each image */
.thumb-x{
  position:absolute; top:4px; right:4px;
  width:18px; height:18px; display:grid; place-items:center;
  border:0; border-radius:50%; cursor:pointer;
  background:#ffffff; color:#64748b; font-weight:700; line-height:1;
  box-shadow:0 1px 4px rgba(0,0,0,.18);
}
.thumb-x:hover{ background:#eef2ff; color:#1d4ed8; }
.thumb-x:focus-visible{ outline:2px solid #3b5bfd; outline-offset:1px; }

/* document name chips */
.doc-chip{
  display:inline-flex; align-items:center; gap:8px;
  max-width:360px; padding:6px 10px; border-radius:999px; font-size:12px; color:#0f172a;
  background:
    linear-gradient(#fff,#fff) padding-box,
    linear-gradient(90deg,#3b5bfd,#00d2ff) border-box;
  border:2px solid transparent; box-shadow:0 2px 8px rgba(0,0,0,.04);
}
.doc-name{
  max-width:240px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.doc-size{ color:#64748b; }
.doc-x{
  all:unset;
  width:18px; height:18px; border-radius:50%;
  display:grid; place-items:center; cursor:pointer; margin-left:4px;
  color:#64748b; font-weight:700; line-height:1;
}
.doc-x:hover{ background:#eef2ff; color:#1d4ed8; }
.doc-x:focus-visible{ outline:2px solid #3b5bfd; outline-offset:2px; }

/* small screens */
@media (max-width:420px){
  .doc-name{ max-width:180px; }
}


/* =====================================================
   8) Message Media (inside bubbles)
   ===================================================== */
.msg-text{
  white-space:pre-wrap; word-break:break-word;
}

/* IMAGES: small clickable thumbnails */
.msg-images{
  display:flex; flex-wrap:wrap; gap:6px;
  margin-top:6px; max-width:min(78vw,420px);
}
.msg-images .img{
  appearance:none; border:0; padding:0; margin:0;
  width:84px; height:84px; border-radius:10px; overflow:hidden;
  background:#fff; border:1px solid #e5e7eb; cursor:pointer;
  box-shadow:0 2px 8px rgba(0,0,0,.04); transition:transform .12s ease;
}
.msg-images .img:hover{ transform:translateY(-1px); }
.msg-images .img:active{ transform:translateY(0); }
.msg-images .img:focus-visible{ outline:2px solid #3b5bfd; outline-offset:2px; }
.msg-images .img img{ width:100%; height:100%; display:block; object-fit:cover; }

/* DOCS: file cards inside the bubble */
.msg-docs{
  display:flex; flex-direction:column; gap:6px;
  margin-top:6px; max-width:min(78vw,420px);
}
.doc-card{
  display:flex; align-items:center; gap:10px;
  padding:8px 10px; border-radius:10px; text-decoration:none;
  background:#fff; border:1px solid #e5e7eb;
  box-shadow:0 2px 8px rgba(0,0,0,.04);
  transition:background .12s ease, border-color .12s ease, transform .12s ease;
}
.doc-card:hover{
  background:#f8fafc; border-color:#dbeafe; transform:translateY(-1px);
}
.doc-card .doc-ico{
  flex:0 0 auto; width:22px; height:22px; object-fit:contain;
  filter:hue-rotate(190deg) saturate(1.2);
}
.doc-card .doc-title{
  flex:1 1 auto; min-width:0;
  font-size:13px; color:#0f172a; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.doc-card .doc-size{ font-size:12px; color:#64748b; }

/* Optional compact layout */
@media (max-width:420px){
  .msg-images .img{ width:72px; height:72px; }
  .doc-card{ padding:7px 9px; }
  .doc-card .doc-title{ font-size:12.5px; }
}


/* =====================================================
   9) Utilities / Animations / Media Queries
   ===================================================== */

/* A11y helper (use alongside .hidden when you want screen-reader-only content) */
.sr-only{
  position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden;
  clip:rect(0,0,0,0); white-space:nowrap; border:0;
}

/* Lottie fit inside avatar circle */
.avatar .lottie-avatar{
  width:95%; height:95%; display:block; pointer-events:none;
}
.avatar .lottie-avatar svg{ width:100%; height:100%; display:block; }

/* Animations */
@keyframes moveGradient{
  0%{ background-position:0% 50%; }
  50%{ background-position:100% 50%; }
  100%{ background-position:0% 50%; }
}
@keyframes blink{
  0%,80%,100%{ opacity:.2; transform:translateY(0); }
  40%{ opacity:1; transform:translateY(-2px); }
}
@keyframes bubbleInLeft{
  0%{ opacity:0; transform:translateX(-10px) translateY(4px) scale(.98); }
  60%{ opacity:1; transform:translateX(0) translateY(0) scale(1.02); }
  100%{ opacity:1; transform:none; }
}
@keyframes bubbleInRight{
  0%{ opacity:0; transform:translateX(10px) translateY(4px) scale(.98); }
  60%{ opacity:1; transform:translateX(0) translateY(0) scale(1.02); }
  100%{ opacity:1; transform:none; }
}
@keyframes metaFade{ to{ opacity:1; transform:none; } }
@keyframes avatarPop{ 0%{ opacity:0; transform:scale(.88); } 100%{ opacity:1; transform:scale(1); } }
@keyframes waveScale{ 0%,100%{ transform:scaleY(.55); } 50%{ transform:scaleY(1.35); } }
@keyframes waveSheen{ 0%{ transform:translateX(-100%); } 100%{ transform:translateX(100%); } }

/* Reduce motion */
@media (prefers-reduced-motion:reduce){
  .bubble.bot, .bubble.me, .row .avatar, .meta-line{ animation:none !important; }
  .avatar.talking{ animation:none !important; }
  .avatar.talking::after{ animation:none !important; }
  .rec-wave::before, .rec-wave span{ animation:none !important; }
}

/* Avatar “talking” pulse */
.avatar.talking{ position:relative; animation:avatarTalk 900ms ease-in-out infinite; }
.avatar.talking::after{
  content:""; position:absolute; inset:-2px; border-radius:50%;
  box-shadow:0 0 0 0 rgba(59,91,253,.35);
  animation:avatarPing 1.3s ease-out infinite; pointer-events:none;
}
@keyframes avatarTalk{ 0%,100%{ transform:translateY(0); } 50%{ transform:translateY(-2px); } }
@keyframes avatarPing{
  0%{ box-shadow:0 0 0 0 rgba(59,91,253,.35); }
  70%{ box-shadow:0 0 0 10px rgba(59,91,253,0); }
  100%{ box-shadow:0 0 0 0 rgba(59,91,253,0); }
}









/* ===== Voice Overlay (refined & responsive to 300×500) ===== */
.voice-overlay{
  position:fixed; inset:0; z-index:9999;
  background:rgba(0,0,0,.5);
  display:grid; place-items:center;
  padding:clamp(8px, 2vw, 20px);
  backdrop-filter:saturate(120%) blur(2px);
  -webkit-backdrop-filter:saturate(120%) blur(2px);
  overscroll-behavior:contain;
}
.voice-sheet{
  width:clamp(300px, 92vw, 720px);
  max-height:min(92dvh, 680px);
  background:#fff; border-radius:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.2);
  display:flex; flex-direction:column; overflow:hidden;
}
.voice-head{
  flex-shrink:0;
  height:64px; padding:0 clamp(12px, 3vw, 16px);
  display:flex; align-items:center; justify-content:space-between;
  border-bottom:1px solid #eef2f7;
  background:linear-gradient(90deg,#3b5bfd 0%, #00a2ff 100%);
  color:#fff;
}
.vh-left{ display:flex; align-items:center; gap:12px }
.vh-title{ font-weight:600; font-size:clamp(14px, 1.7vw, 16px) }
.vh-close{
  border:0; background:transparent; color:#fff; font-size:20px; line-height:1;
  width:36px; height:36px; border-radius:10px; cursor:pointer;
}
.vh-close:hover{ background:rgba(255,255,255,.15) }

.vh-body{
  flex: 1 1 auto;
  padding: 22px 18px 108px;
  display:flex; flex-direction:column; gap:60px; overflow:auto;
}

/* gender switch (unchanged) */
.gender-switch{
  display:flex; flex-wrap:wrap; gap:10px; background:#f3f4f6;
  padding:6px; border-radius:999px; align-self:center;
}
.gender-btn{
  border:0; background:transparent;
  padding:clamp(8px, 1.2vh, 10px) clamp(14px, 3.2vw, 16px);
  border-radius:999px; font-weight:600; cursor:pointer;
  font-size:clamp(13px, 1.6vw, 14px);
}
.gender-btn.active{ background:#fff; box-shadow:0 4px 14px rgba(0,0,0,.08) }

/* ─────────────────────────────────────────────────────────────
   MIC BUTTON —
   ───────────────────────────────────────────────────────────── */
.mic-btn{
  position:relative; align-self:center;
  width:clamp(120px, 32vw, 180px); height:clamp(120px, 32vw, 180px);
  border-radius:50%;
  border:0; background:#0f172a; color:#fff;
  display:grid; place-items:center; gap:10px; cursor:pointer;
  box-shadow:0 14px 40px rgba(0,0,0,.25);
  touch-action:manipulation;
  isolation:isolate;
  overflow:visible;

  /* THEME + Loudness control
     -------------------------------------------- */
  --brand-1: #3b5bfd;     /* left blue */
  --brand-2: #00a2ff;     /* right cyan */
  --ring-w : calc(6px + var(--vu, 0) * 10px);         /* ring thickness grows with loudness */
  --scale  : calc(.88 + var(--vu, 0) * .18);          /* overall visual scale */
  --alpha  : calc(.35 + var(--vu, 0) * .55);          /* glow opacity vs loudness */
  --halo-c : rgba(59,91,253, .35);                    /* halo base */
}

/* keep icon + label sizes */
.mic-btn img{ width:clamp(34px, 6vw, 42px); height:auto; filter:invert(1) }
.mic-label{ font-size:clamp(11px, 1.5vw, 12px); opacity:.9; margin-top:8px }

/* pulse container */
.mic-btn .mic-pulse{
  position:absolute; inset:0; border-radius:50%;
  pointer-events:none; z-index:0; display:block;
  transform: scale(var(--scale));
}

/* A. Inner aurora (subtle) */
.mic-btn::before{
  content:""; position:absolute; inset:14%; border-radius:50%;
  background:
    radial-gradient(60% 60% at 45% 40%, rgba(255,255,255,.20), transparent 62%),
    radial-gradient(64% 64% at 55% 60%, rgba(46,105,255,.26), transparent 62%),
    conic-gradient(from 0deg, rgba(0,184,255,.18), rgba(46,105,255,.18), rgba(0,184,255,.18));
  filter: blur(14px) saturate(115%);
  opacity:0; transform:rotate(0deg) scale(.98);
  animation:auraDrift 7s ease-in-out infinite alternate paused;
  mix-blend-mode:screen;
}

/* B. Soft outer halo (breathes with loudness) */
.mic-btn::after{
  content:""; position:absolute; inset:-12%; border-radius:50%;
  background: radial-gradient(circle at 50% 50%, var(--halo-c), transparent 62%);
  opacity:0; animation:haloBreath 2s ease-in-out infinite paused;
}

/* C. Main ring with rotating shimmer (reacts to loudness) */
.mic-btn .mic-pulse::before{
  content:""; position:absolute; inset:calc(-1 * clamp(12px, 2.6vw, 22px)); border-radius:50%;
  background:
    /* subtle inner glow */
    radial-gradient(circle at 50% 50%, rgba(255,255,255,.20), rgba(255,255,255,0) 62%) padding-box,
    /* brand gradient */
    conic-gradient(from 0deg, var(--brand-1), var(--brand-2), var(--brand-1)) border-box;
  /* crisp ring edge using VU-controlled thickness */
  -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - var(--ring-w)), #000 0);
          mask: radial-gradient(farthest-side, transparent calc(100% - var(--ring-w)), #000 0);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.03) inset,
    0 0 22px rgba(46,105,255, calc(.28 * var(--alpha))),
    0 0 120px rgba(46,105,255, calc(.22 * var(--alpha)));
  opacity: var(--alpha);
  transform: rotate(0deg);
  animation: ringSweep 2.1s linear infinite paused;
}

/* D. Expanding ripple (one additional layer) */
.mic-btn .mic-pulse::after{
  content:""; position:absolute; inset:calc(-1 * clamp(12px, 2.6vw, 22px)); border-radius:50%;
  background:
    radial-gradient(circle at 50% 50%, rgba(191,224,255,.24), rgba(255, 255, 255, 0) 62%) padding-box,
    conic-gradient(from 0deg, var(--brand-1), var(--brand-2), var(--brand-1)) border-box;
  -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - var(--ring-w)), #000 0);
          mask: radial-gradient(farthest-side, transparent calc(100% - var(--ring-w)), #000 0);
  filter: drop-shadow(0 0 18px rgba(46,105,255,.30));
  opacity: calc(.85 * var(--alpha));
  transform: scale(.72);
  animation: pulseRing 2s cubic-bezier(.22,.61,.36,1) infinite paused;
}

/* Run animations only when active */
.mic-btn.live::before,
.mic-btn.live::after,
.mic-btn.live .mic-pulse::before,
.mic-btn.live .mic-pulse::after{ animation-play-state:running; opacity:1; }

/* Keyframes */
@keyframes ringSweep{ to { transform: rotate(360deg); } }
@keyframes pulseRing{
  0%   { transform: scale(.72); opacity: calc(.90 * var(--alpha)) }
  60%  { opacity: calc(.30 * var(--alpha)) }
  100% { transform: scale(1.20); opacity: 0 }
}
@keyframes auraDrift{
  0%   { transform: rotate(0deg) scale(.98) }
  100% { transform: rotate(18deg) scale(1.03) }
}
@keyframes haloBreath{
  0%,100% { transform: scale(.95); opacity: calc(.26 + var(--vu,0) * .25); }
  50%     { transform: scale(1.05); opacity: calc(.54 + var(--vu,0) * .25); }
}

/* speaking animation (header) — unchanged */
.speak-anim{
  display:inline-flex; gap:3px; height:18px; align-items:flex-end;
}
.speak-anim span{
  width:3px; height:100%;
  background: linear-gradient(180deg,#ffffff,#eaf2ff);
  border-radius:2px; opacity:.55;
  transform-origin:bottom center; transform:scaleY(.25);
  box-shadow: 0 0 10px rgba(255,255,255,.35);
}
.speak-anim.on span:nth-child(1){ animation:speakWave 900ms ease-in-out -0.10s infinite; }
.speak-anim.on span:nth-child(2){ animation:speakWave 880ms ease-in-out -0.05s infinite; }
.speak-anim.on span:nth-child(3){ animation:speakWave 860ms ease-in-out 0s infinite; }
.speak-anim.on span:nth-child(4){ animation:speakWave 880ms ease-in-out .05s infinite; }
.speak-anim.on span:nth-child(5){ animation:speakWave 900ms ease-in-out .10s infinite; }
@keyframes speakWave{
  0%,100%{ transform:scaleY(.25) }
  20%{ transform:scaleY(.9) }
  40%{ transform:scaleY(.5) }
  60%{ transform:scaleY(1) }
  80%{ transform:scaleY(.4) }
}

/* responsive tweaks (unchanged) */
@media (max-width:560px){
  .voice-sheet{ width:96vw; max-height:94dvh; border-radius:16px; }
  .voice-head{ height:56px; }
  .vh-left{ gap:10px; }
}
@media (max-width:360px){
  .vh-title{ font-size:14px; }
  .gender-switch{ gap:8px; }
  .gender-btn{ padding:8px 12px; font-size:13px; }
}
@media (max-width:320px), (max-height:540px){
  .voice-sheet{ width:100vw; border-radius:0; max-height:100dvh; }
  .vh-body{ padding:12px 12px 24px; gap:14px; }
  .mic-btn{ width:120px; height:120px; }
}

/* Reduced motion */
@media (prefers-reduced-motion:reduce){
  .mic-btn::before,
  .mic-btn::after,
  .mic-btn .mic-pulse::before,
  .mic-btn .mic-pulse::after{ animation:none !important; }
}


/*  chatbot thinking icon overlay */

/* Container sets the overall size */
.bot-wrap{
  position: relative;
  width: 56px;         /* your desired bot width */
  height: 56px;        /* keep aspect ratio of the bot */
}

/* Make the base robot fill the container (was 50% — that caused mismatch) */
.bot-wrap .lottie-avatar{
  width: 100%;
  height: 100%;
  display: block;
}

/* Overlay sized/positioned relative to the same container */
.bot-wrap .overlay{
  position: absolute;
  /* size of the overlay relative to the bot container */
  width: 34%;
  aspect-ratio: 1 / 1;     /* keeps it perfectly square */
  left: 60%;               /* nudge to where you want (head/hand) */
  top: 14%;
  pointer-events: none;
  z-index: 2;

  /* make sure internal SVG respects the box */
  display: block;
}

/* (Optional) When “thinking”, make overlay a touch smaller so it never looks bigger */
.bot-wrap.thinking .overlay{
  transform: scale(0.85);
  transform-origin: center;
}
